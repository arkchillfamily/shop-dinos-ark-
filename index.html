<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Shop Dinos ARK</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:'Orbitron',monospace;color:#fff;
      background:linear-gradient(135deg,#0f0f23 0%,#1a1a3e 50%,#2d1b4e 100%);
      min-height:100vh;
    }
    nav{background:rgba(0,0,0,0.6);padding:1rem;border-bottom:2px solid #ffd700;display:flex;justify-content:center;gap:2rem;position:sticky;top:0;z-index:100}
    nav a{color:#ffd700;text-decoration:none;font-weight:700}
    .container{max-width:1200px;margin:0 auto;padding:2rem}
    .header{text-align:center;margin-bottom:2rem}
    .title{font-size:2.5rem;font-weight:900;background:linear-gradient(45deg,#ffd700,#ffed4e);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 20px rgba(255,215,0,0.4)}
    .subtitle{color:#a0a0ff;margin-top:.5rem}
    .categories{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:1.5rem;margin-top:1.5rem}
    .category-card{background:rgba(255,255,255,0.03);padding:1.2rem;border-radius:12px;border:1px solid rgba(255,255,255,0.04)}
    .category-title{color:#ffd700;margin-bottom:.8rem;text-align:center;font-weight:700}
    .dino-item{display:flex;justify-content:space-between;align-items:center;padding:.8rem;border-radius:10px;background:rgba(255,255,255,0.02);cursor:pointer;margin-bottom:.6rem;transition:all .15s}
    .dino-item:hover{transform:translateX(6px);background:rgba(255,255,255,0.06)}
    .dino-name{font-weight:600}
    .dino-price{font-weight:700;color:#ffd700}
    /* Panier */
    #panier{margin-top:1.2rem;padding:1rem;border-radius:12px;border:2px solid #ffd700;background:rgba(255,215,0,0.06)}
    #panier h3{color:#ffd700;margin-bottom:.6rem}
    #panier-list{list-style:none;padding:0;margin:0 0 .8rem 0}
    #panier-list li{display:flex;justify-content:space-between;align-items:center;padding:.35rem 0;border-bottom:1px dashed rgba(255,255,255,0.03)}
    .remove-btn{color:#ff5252;cursor:pointer;margin-left:.75rem}
    #totalPrix{font-weight:800;color:#ffd700;margin-bottom:.6rem;display:block}
    #ouvrirTicketBtn{display:none;width:100%;padding:.9rem;border-radius:10px;border:none;background:linear-gradient(45deg,#00c851,#33d96c);color:#fff;font-weight:800;cursor:pointer}
    /* Modal */
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:2000}
    .modal-content{width:95%;max-width:520px;background:#111428;padding:1.2rem;border-radius:12px;border:2px solid #ffd700}
    .form-group{margin-bottom:.8rem}
    label{display:block;margin-bottom:.3rem;color:#ffd700;font-weight:700}
    input[type="text"],textarea{width:100%;padding:.6rem;border-radius:8px;border:1px solid #ffd700;background:rgba(255,255,255,0.04);color:#fff}
    textarea{min-height:90px;resize:vertical}
    .submit-btn{width:100%;padding:.8rem;border-radius:10px;border:none;background:linear-gradient(45deg,#ffd700,#ffed4e);font-weight:800;cursor:pointer;margin-top:.5rem}
    .close-btn{background:#ff4d4d !important}
    @media(max-width:700px){.title{font-size:1.8rem}}
  </style>
</head>
<body>
  <nav>
    <a href="#home">Accueil</a>
    <a href="#shop">Shop</a>
    <a href="#tickets">Tickets</a>
    <a href="#contact">Contact</a>
  </nav>

  <div class="container" id="home">
    <div class="header">
      <h1 class="title">SHOP DINOS ARK</h1>
      <div class="subtitle">Choisis tes dinos, valide le panier puis ouvre le ticket priv√© depuis Discord</div>
    </div>

    <div class="categories" id="shop">
      <!-- Dinos 225 -->
      <div class="category-card">
        <div class="category-title">Dinos Level 225</div>
        <div class="dino-item" data-name="ü¶ñ Petit / √âpaule" data-price="500"><span class="dino-name">ü¶ñ Petit / √âpaule</span><span class="dino-price">500</span></div>
        <div class="dino-item" data-name="ü¶ï Moyen" data-price="750"><span class="dino-name">ü¶ï Moyen</span><span class="dino-price">750</span></div>
        <div class="dino-item" data-name="üêâ Sp√©cial" data-price="1500"><span class="dino-name">üêâ Sp√©cial</span><span class="dino-price">1500</span></div>
      </div>

      <!-- Dinos 450 -->
      <div class="category-card">
        <div class="category-title">Dinos Level 450</div>
        <div class="dino-item" data-name="ü¶ñ Petit / √âpaule" data-price="750"><span class="dino-name">ü¶ñ Petit / √âpaule</span><span class="dino-price">750</span></div>
        <div class="dino-item" data-name="ü¶ï Moyen" data-price="1000"><span class="dino-name">ü¶ï Moyen</span><span class="dino-price">1000</span></div>
        <div class="dino-item" data-name="üêâ Sp√©cial" data-price="2000"><span class="dino-name">üêâ Sp√©cial</span><span class="dino-price">2000</span></div>
        <div class="dino-item" data-name="üíÄ Moros" data-price="3000"><span class="dino-name">üíÄ Moros</span><span class="dino-price">3000</span></div>
      </div>

      <!-- Dinos Shiny -->
      <div class="category-card">
        <div class="category-title">Dinos Shiny ‚ú®</div>
        <div class="dino-item" data-name="ü¶ñ‚ú® Petit / √âpaule" data-price="1000"><span class="dino-name">ü¶ñ‚ú® Petit / √âpaule</span><span class="dino-price">1000</span></div>
        <div class="dino-item" data-name="ü¶ï‚ú® Moyen" data-price="2000"><span class="dino-name">ü¶ï‚ú® Moyen</span><span class="dino-price">2000</span></div>
        <div class="dino-item" data-name="üêâ‚ú® Sp√©cial" data-price="3000"><span class="dino-name">üêâ‚ú® Sp√©cial</span><span class="dino-price">3000</span></div>
        <div class="dino-item" data-name="üíÄ‚ú® Moros" data-price="4000"><span class="dino-name">üíÄ‚ú® Moros</span><span class="dino-price">4000</span></div>
      </div>
    </div>

    <!-- Panier -->
    <div id="panier">
      <h3>üõí Votre panier</h3>
      <ul id="panier-list"></ul>
      <span id="totalPrix">Total : 0 Vifs d'Or</span>
      <button id="ouvrirTicketBtn">‚úÖ Valider le panier</button>
    </div>
  </div>

  <!-- Modal (restreint : s'ouvre sur validation du panier) -->
  <div id="ticketModal" class="modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true">
      <h2 style="color:#ffd700;margin-bottom:.6rem">üé´ Valider la commande</h2>
      <form id="ticketForm">
        <div class="form-group">
          <label for="discordName">Nom Discord</label>
          <input id="discordName" type="text" placeholder="Pseudo#1234" required />
        </div>
        <div class="form-group">
          <label for="dinoName">Dinos choisis</label>
          <input id="dinoName" type="text" readonly />
        </div>
        <div class="form-group">
          <label for="dinoPrice">Prix total</label>
          <input id="dinoPrice" type="text" readonly />
        </div>
        <div class="form-group">
          <label for="additionalInfo">Infos suppl√©mentaires</label>
          <textarea id="additionalInfo" placeholder="Couleurs, niveau, pr√©cisions..."></textarea>
        </div>

        <button type="submit" class="submit-btn">Envoyer la commande</button>
        <button type="button" id="fermerModal" class="submit-btn close-btn">‚ùå Fermer</button>
      </form>
    </div>
  </div>

<script>
/*
 * >>> REMPLACE ICI AVEC TES PROPRES VALEURS <<<
 * - DISCORD_WEBHOOK_URL : l'URL du webhook du canal Discord qui doit recevoir les commandes
 * - DISCORD_SERVER_ID  : ID de ton serveur (copier via mode d√©veloppeur)
 * - DISCORD_CHANNEL_ID : ID du salon "#tickets" ou autre (copier via mode d√©veloppeur)
 */
const DISCORD_WEBHOOK_URL = "https://discord.com/api/webhooks/1416901654132822157/utEGLOc5vqYqgP9pEmRS4QZlI48fWwo96eHSiEOkkOU5DuQW83edGjz6qG-v_krYOjOo";
const DISCORD_SERVER_ID  = "1202723157845348403";
const DISCORD_CHANNEL_ID = "1255528001534300173";

/* url vers le salon Discord (utilis√©e pour le bouton dans l'embed) */
const DISCORD_CHANNEL_URL = `https://discord.com/channels/${DISCORD_SERVER_ID}/${DISCORD_CHANNEL_ID}`;

/* Variables panier */
let panier = [];
let total = 0;

/* Utilitaires */
function formatPrix(n){ return `${n} Vifs d'Or`; }

/* Met √† jour l'affichage du panier */
function majPanier(){
  const ul = document.getElementById('panier-list');
  ul.innerHTML = '';
  panier.forEach((item, idx)=>{
    const li = document.createElement('li');
    li.style.gap = '8px';
    const left = document.createElement('span');
    left.textContent = `${item.name} - ${item.price} Vifs d'Or`;
    const remove = document.createElement('button');
    remove.type = 'button';
    remove.textContent = '‚ùå';
    remove.title = 'Retirer';
    remove.className = 'remove-btn';
    remove.style.background = 'transparent';
    remove.style.border = 'none';
    remove.style.fontSize = '1rem';
    remove.style.cursor = 'pointer';
    remove.onclick = () => {
      // retirer l'item √† l'index courant
      panier.splice(idx,1);
      total -= item.price;
      if(total < 0) total = 0;
      majPanier();
    };
    li.appendChild(left);
    li.appendChild(remove);
    ul.appendChild(li);
  });
  document.getElementById('totalPrix').textContent = `Total : ${total} Vifs d'Or`;
  document.getElementById('ouvrirTicketBtn').style.display = panier.length > 0 ? 'block' : 'none';
}

/* Click sur un dino : ajout au panier */
document.querySelectorAll('.dino-item').forEach(div=>{
  div.addEventListener('click', ()=>{
    const name = div.dataset.name || div.querySelector('.dino-name')?.textContent || 'Dino';
    const price = parseInt(div.dataset.price || '0', 10) || 0;
    panier.push({name, price});
    total += price;
    majPanier();
  });
});

/* Ouvrir modal au clic "Valider le panier" */
document.getElementById('ouvrirTicketBtn').addEventListener('click', ()=>{
  document.getElementById('dinoName').value = panier.map(p=>p.name).join(', ');
  document.getElementById('dinoPrice').value = formatPrix(total);
  const modal = document.getElementById('ticketModal');
  modal.style.display = 'flex';
  modal.setAttribute('aria-hidden','false');
});

/* Fermer modal */
document.getElementById('fermerModal').addEventListener('click', ()=>{
  const modal = document.getElementById('ticketModal');
  modal.style.display = 'none';
  modal.setAttribute('aria-hidden','true');
});

/* Envoi vers Discord (webhook) */
document.getElementById('ticketForm').addEventListener('submit', async (e)=>{
  e.preventDefault();

  // s√©curit√© : v√©rifier que le webhook et les IDs ne sont pas rest√©s en placeholder
  if(!DISCORD_WEBHOOK_URL || DISCORD_WEBHOOK_URL.includes('TON_WEBHOOK') ){
    alert('‚ö†Ô∏è Merci de remplacer DISCORD_WEBHOOK_URL par ton webhook dans le script.');
    return;
  }
  if(!DISCORD_SERVER_ID || !DISCORD_CHANNEL_ID || DISCORD_SERVER_ID.includes('ID_SERVEUR') || DISCORD_CHANNEL_ID.includes('ID_SALON')){
    // On autorise l'envoi m√™me si l'URL du salon n'est pas configur√©e, mais on pr√©vient
    console.warn('IDs serveur/salon non renseign√©s - le bouton dans Discord ne fonctionnera pas tant que vous ne les avez pas ajout√©s.');
  }

  const discordName = document.getElementById('discordName').value.trim() || 'Non renseign√©';
  const dinos = document.getElementById('dinoName').value || 'Aucun';
  const prix = document.getElementById('dinoPrice').value || formatPrix(total);
  const info = document.getElementById('additionalInfo').value || '';

  // embed
  const embed = {
    title: "üé´ Nouvelle commande - Shop Dinos ARK",
    color: 0xFFD700,
    fields: [
      { name: "üéÆ Joueur", value: discordName, inline: true },
      { name: "ü¶ñ Dinos", value: dinos, inline: false },
      { name: "üí∞ Prix Total", value: prix, inline: true }
    ],
    timestamp: new Date().toISOString(),
    footer: { text: "Shop Dinos ARK" }
  };
  if(info) embed.fields.push({ name: "üìù Infos suppl√©mentaires", value: info, inline: false });

  // composant bouton : lien vers ton salon Discord
  const components = [
    {
      type: 1,
      components: [
        {
          type: 2,
          style: 5,
          label: "üì© Ouvrir un ticket priv√©",
          url: DISCORD_CHANNEL_URL // si IDs non renseign√©s, url contiendra le placeholder
        }
      ]
    }
  ];

  try {
    const payload = {
      username: "ü¶ñ Shop Dinos ARK",
      embeds: [embed],
      components: components
    };

    const resp = await fetch(DISCORD_WEBHOOK_URL, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });

    if(!resp.ok){
      const text = await resp.text().catch(()=> '');
      throw new Error(`Webhook error ${resp.status} ${resp.statusText} ${text}`);
    }

    alert('‚úÖ Commande envoy√©e sur Discord ! Le message contient un bouton pour ouvrir le ticket priv√©.');
    // reset panier
    panier = [];
    total = 0;
    majPanier();
    document.getElementById('ticketModal').style.display = 'none';
    document.getElementById('ticketModal').setAttribute('aria-hidden','true');
    document.getElementById('ticketForm').reset();

  } catch (err) {
    console.error(err);
    alert('‚ùå √âchec envoi webhook. V√©rifie l\'URL du webhook dans le script et les permissions du webhook dans Discord.');
  }
});

/* Fermeture du modal si clic √† l'ext√©rieur */
window.addEventListener('click', (e)=>{
  const modal = document.getElementById('ticketModal');
  if(e.target === modal){
    modal.style.display = 'none';
    modal.setAttribute('aria-hidden','true');
  }
});
</script>
</body>
</html>
